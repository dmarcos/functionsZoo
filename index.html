<!DOCTYPE html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <link rel="stylesheet" href="css/normalize.min.css">
        <link rel="stylesheet" href="css/main.css">

        <!--[if lt IE 9]>
            <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
            <script>window.html5 || document.write('<script src="js/vendor/html5shiv.js"><\/script>')</script>
        <![endif]-->
    </head>
    <body>

        <div id="container">
          <section id="functionsMenu">         
            <input id="sin" type="radio" name="function" value="sin" checked>
            <label for="sin">\(y = sin(x)\)</label>
            <input id="cos" type="radio" name="function" value="cos">
            <label for="cos">\(y = cos(x)\)</label>
            <input id="tan" type="radio" name="function" value="tan">
            <label for="tan">\(y = tan(x)\)</label>
            <input id="line" type="radio" name="function" value="line">
            <label for="line">\(y = x\)</label>
            <input id="parabola" type="radio" name="function" value="parabola">
            <label for="parabola">\(y = x^2\)</label>
            <input id="inverse" type="radio" name="function" value="inverse">
            <label for="inverse">\(y = 1/x\)</label>
            <input id="log" type="radio" name="function" value="log">
            <label for="log">\(y = log(x)\)</label>
          </section>
          <div id="blackboard">
            <canvas></canvas>
          </div>
        </div>
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
        </script>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.9.1.js"><\/script>')</script>

        <script src="js/main.js"></script>
        <script>
          function fitToContainer(canvas){
            canvas.style.width='100%';
            canvas.style.height='100%';
            canvas.width  = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
          }

          var functionsLibrary = {
            cos : {
              f : function(x) {
                return Math.cos(x);
              },
              scale: Math.PI*2
            },
            sin : {
              f : function(x) {
                return Math.sin(x);
              },
              scale: Math.PI*2 
            },
            tan : {
              f: function(x) {
                return Math.tan(x);
              },
              scale: Math.PI*2
            },
            line : {
              f : function(x) {
                return x;
              },
              scale: 1
            },
            parabola : {
              f : function(x) {
                return Math.pow(x,2);
              },
              scale: 1
            },
            inverse : {
              f : function(x) {
                return 1/x;
              },
              scale: 1
            },
            log : {
              f : function(x) {
                return Math.log(x);
              },
              scale: 1
            }

          };

          var CartesianCoordinates = function(xMin, xMax, yMin, yMax) {
            this.xMin = xMin;
            this.xMax = xMax;
            this.yMin = yMin;
            this.yMax = yMax;
          };

          CartesianCoordinates.prototype.drawGrid = function(canvas, stepX, stepY, color){
            var context = canvas.getContext('2d');
            var i;
            context.strokeStyle = color || 'rgb(51,51,50)';
            for (i=0;i<canvas.width;i+=stepX) {
              context.beginPath();
              context.moveTo(i, 0);
              context.lineTo(i, canvas.height);
              context.stroke();
            }
            for (i=0;i<canvas.height;i+=stepY) {
              context.beginPath();
              context.moveTo(0, i);
              context.lineTo(canvas.width, i);
              context.stroke();
            }
          };

          CartesianCoordinates.prototype.drawFunction = function(f, scale, color){
            var i;
            var canvas = document.querySelector('canvas');
            var context = canvas.getContext('2d');
            var factor = scale || 1;
            context.strokeStyle = color || 'white';
            context.lineWidth = 1;          
            context.beginPath();
            var points = [];
            var step = 1;
            for (i=0;i<canvas.width;i+=step) { 
              points.push({
                x: i*step, 
                y: ((canvas.height / 2) - (canvas.height / 2)*f((i * step / canvas.width)*factor))
              });
            }
            for (i=0;i<points.length-1;i++) {
              var xc = (points[i].x + points[i + 1].x) / 2;
              var yc = (points[i].y + points[i + 1].y) / 2;
              context.quadraticCurveTo(points[i].x, points[i].y, xc, yc);
            }
            // context.moveTo(0, canvas.height / 2);
            // context.moveTo(points[0].x, points[0].y); 
            // for(i=1;i<canvas.width;i+=step) {
            //  context.lineTo(points[i].x, points[i].y);
            //  context.moveTo(points[i].x, points[i].y);
            // }
            context.stroke();
          };

          var coordinates = new CartesianCoordinates(0,0,0,0);

          $("#functionsMenu input").click(function(input){
            var graph = functionsLibrary[input.target.value];
            resetCanvas();
            coordinates.drawFunction(graph.f, graph.scale, 'red');
          });

          function resetCanvas(){
            var canvas = document.querySelector('canvas');
            var context = canvas.getContext('2d');
            fitToContainer(canvas);
            context.fillStyle='rgb(26,26,26)';
            context.fillRect(0, 0, canvas.width, canvas.height);
            coordinates.drawGrid(canvas, canvas.width / 2, canvas.height / 2);
          };

          document.addEventListener('DOMContentLoaded',function(){
            resetCanvas();
            coordinates.drawFunction(functionsLibrary[$("#functionsMenu input:checked").first().attr('value')], Math.PI*2, 'red');
          });
        </script>
    </body>
</html>
